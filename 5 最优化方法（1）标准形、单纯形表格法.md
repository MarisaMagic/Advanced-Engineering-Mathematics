<h1>
    <div align='center'>
        第五章 最优化方法（1）
        标准形、单纯形表格法
    </div>
</h1>


## 线性规划问题的标准形

### 线性规划问题

**线性规划问题简述**：在若干个线性约束下，让一个线性目标函数尽量“大”或尽量“小”的问题。

1. **决策变量**
   用若干个变量 $x_1, x_2, \dots, x_n$ 表示要做的决策

2. **目标函数是线性的**
   想要优化（最大化或最小化）的指标是一个一次函数，比如

   $$
   \max\ z = 3x_1 + 2x_2 - x_3
   $$

   或

   $$
   \min\ z = c_1x_1 + c_2x_2 + \cdots + c_nx_n.
   $$

3. **约束条件是线性的**
   每个限制都是一次式，例如

   $$
   \begin{aligned}
   2x_1 + x_2 &\le 10,\\
   -x_1 + 3x_2 &\ge 6,\\
   x_1 + x_2 &= 5,\\
   x_i &\ge 0.
   \end{aligned}
   $$

   这些统称为**线性约束**。

4. **标准抽象形式**
   一般写成矩阵形式：
   
   $$
   \begin{aligned}
   \min\quad &c^T x \\
   \text{s.t. }\quad &Ax \le b,\\
   &x \ge 0.
   \end{aligned}
   $$
   
   或通过变形写成等式 $Ax=b$ 再加上松弛变量。

### 标准形

任意线性规划问题都可通过变量变换与约束调整，转换为 **标准形**（Standard Form），其形式如下：
$$
\begin{aligned}
\min\quad &c^T x \\
\text{s.t. }\quad &Ax = b,\\
&x \ge 0.
\end{aligned}
$$
其中
* $A$ 为 $m\times n$ 矩阵，且 $\operatorname{rank}(A) = m \le n$；
* $b$ 为 $m$-维向量；
* $x$ 为决策变量向量；
* $c$ 为目标函数系数向量；
* 所有变量必须满足 $x_i \ge 0$，称为 **非负约束**。

**将任意 线性规划问题 转换为 标准形 的步骤：**

1. 若原问题为**极大化**目标，即 $\max c^Tx$，则乘以 $-1$ 转化为极小化：

   $$
   \max c^Tx \quad \Rightarrow \quad \min (-c^T x)
   $$

2. 若约束右端项 $b_i<0$，则将该约束两边乘以 $-1$，使其变成右端为正的等式。

3. 若约束为**不等式**，则：

   * 对于 $\le$ 约束：**加入松弛变量** $s_i \ge 0$
     $$
     a_i x \le b_i \Rightarrow a_i x + s_i = b_i, \quad s_i \ge 0
     $$

   * 对于 $\ge$ 约束：**加入剩余变量**（surplus Variable）$s_i$，并含人工变量：
     $$
     a_i x \ge b_i \Rightarrow a_i x - s_i = b_i, \quad s_i \ge 0
     $$

4. 若变量允许自由，即 **无非负限制**，例如 $x_j$ 自由，则可写成：

   $$
   x_j = x_j^{'} - x_j^{''}, \quad x_j^{'},x_j^{''} \ge 0.
   $$




### 例题 1

> 将下面的线性规划问题转换为标准形
> $$
> \begin{aligned}
> \max \quad &2x_1 - 3x_2 + x_3 + 3x_4 \\
> \text{s.t. } \quad &2x_1 - x_2 + 3x_3 + x_4 \ge 3\\
> &3x_1 + 2x_2 + 2x_4 = 7 \\
> &-x_1 + 4x_2 - 3x_3 - x_4 \le 6 \\
> &x_1, x_3, x_4 \ge 0, \ x_2 无约束.
> \end{aligned}
> $$

解答：

令 $x_2 = x_2^{'} - x_2^{''}$，其中 $x_2^{'}, x_2^{''} \ge 0$. 引入剩余变量 $s_1 \ge 0$，引入松弛变量 $s_2 \ge 0$，则标准形为：
$$
\begin{aligned}
\min \quad & -2x_1 + 3x_2 - x_3 - 3x_4 \\
\text{s.t. } \quad & 2x_1 - x_2 + 3x_3 + x_4 - s_1 = 3 \\
& 3x_1 + 2x_2 + 2x_4 = 7 \\
& -x_1 + 4x_2 - 3x_3 - x_4 + s_2 = 6 \\
& x_1, x_3, x_4, s_1, s_2, x_2^{'}, x_2^{''} \ge 0
\end{aligned}
$$

---



## 单纯形表格法

### 单纯形表格法基本步骤

1. **标准化 + 引入松弛变量**

   * 把线性规划化成
     $$
     \begin{aligned}
     \min \quad & c^Tx,\\ 
     \text{s.t. } \quad & Ax = b,\\
     & x\ge0
     \end{aligned}
     $$
   * 对“≤”约束加松弛变量，使之变成等式。
   * **初始基变量** 一般就是这些**松弛变量**，得到初始基本可行解。

2. **构造初始单纯形表**

   * 每一行是一条约束；

   * 最后一行是目标行，初始目标行系数（也称为 **“检验数”**）计算：
     $$
     r_j = Z_j - C_j = c_B^\top a_j - C_j,
     $$

     其中 $c_B$ 为当前基变量的成本向量，$a_j$ 为第 $j$ 列约束系数，$C_j$ 为第 $j$ 个变量的目标系数。 在初始表中，如果基变量都是松弛变量且其成本为 0，则 $Z_j = 0$，于是

     $$
     r_j = -C_j,
     $$

     即“初始目标行的检验数等于原目标函数系数取相反数”。

3. **选换入变量（进基变量）**

   * 看目标行中 **非基变量** 对应的系数；
   * 对最小化问题：选 **最正** 的那个作为换入变量（表示它最有潜力继续降低目标值）。
   * 如果所有这些系数都 $\le 0$（对最小化），说明再也降不下去了 → **当前解最优**。

4. **选换出变量（离基变量）——最小比值检验**

   * 在换入变量所在列中，只看 **正系数** 行，计算
     $$
     \frac{\text{右端常数}}{\text{该列系数}}
     $$
   * 取最小的那个比值对应的行，该行的基变量就是要被换出的变量。
   * 这一步直观上是在算：在不破坏可行性的前提下，新变量最多能增大到多少。

5. **枢轴运算（行变换）**

   * 把“换入变量所在的那一格”作为枢轴元素；
   * 通过行初等变换，使这一列变成单位列：

     * 枢轴所在行：把枢轴化为 1；
     * 其他行（**包括目标行**）：在该列系数变成 0。
   * 更新表后，就得到一个新的基本可行解（基变量换了一组）。

6. **重复 3–5 步，直到满足最优性条件**

   * 对最小化：当目标行中所有非基变量对应的系数（或检验数）**都 $\le 0$** 时停止；
   * 此时表中 **右端常数就是最优解的变量值**，**目标行右端常数就是最优目标值**。



### 例题 2 

> 用单纯形方法求解下列线性规划问题
> $$
> \begin{aligned}
> \min \quad & x_1 - 3x_2 - x_3 \\
> \text{s.t. } \quad & 3x_1 - x_2 + 2x_3 \le 7 \\
> & -2x_1 + 4x_2 \le 12 \\
> & -4x_1 + 3x_2 + 8x_3 \le 10 \\
> & x_1, x_2, x_3 \ge 0.
> \end{aligned}
> $$

解答：

- 初始化单纯形表格（初始基变量为 $s_1, s_2, s_3$）

  对应标准形：
  $$
  \begin{aligned}
  \min \quad & x_1 - 3x_2 - x_3 \\
  \text{s.t. } \quad & 3x_1 - x_3 + 2x_3 + s_1 = 7 \\
  & -2x_1 + 4x_2 + s_2 = 12 \\
  & -4x_1 + 3x_2 + 8x_3 + s_3 = 10 \\
  & x_1, x_2, x_3, s_1, s_2, s_3 \ge 0.
  \end{aligned}
  $$
  
  初始单纯形表格：
  | 基变量     | $x_1$（1） | $x_2$（-3） | $x_3$（-1） | $s_1$（0） | $s_2$（0） | $s_3$（0） | 右端常数 |
  | ---------- | ---------- | ----------- | ----------- | ---------- | ---------- | ---------- | -------- |
  | $s_1$（0） | 3          | -1          | 2           | 1          | 0          | 0          | 7        |
  | $s_2$（0） | -2         | 4           | 0           | 0          | 1          | 0          | 12       |
  | $s_3$（0） | -4         | 3           | 8           | 0          | 0          | 1          | 10       |
  | 目标行     | -1         | 3           | 1           | 0          | 0          | 0          | 0        |
  
  
  
- **第 1 次 换基**（$x_2$ 进基、$s_2$ 离基）

  - **选定进基变量**（看目标行最正的系数对应的变量）：

    目标行中最正的系数为 $3$，对应变量 $x_2$。因此，$x_2$ 作为 **进基变量**。

  - **选定离基变量**（只看 $x_2$ 对应列的正数系数，找到 $\frac{右端常数}{系数}$ 最小比值）：

    发现 $s_2$ 对应的比值 $\frac{12}{4} = 3$ 最小。因此，$s_2$ 作为 **离基变量**。

  将 $x_2$ 换到 $s_2$ 的基变量位置， 之后行变换，将 **进基变量** $x_2$ 这一列变为 **单位列**：

  | 基变量      | $x_1$（1）     | $x_2$（-3） | $x_3$（-1） | $s_1$（0） | $s_2$（0）     | $s_3$（0） | 右端常数 |
  | ----------- | -------------- | ----------- | ----------- | ---------- | -------------- | ---------- | -------- |
  | $s_1$（0）  | $\frac{5}{2}$  | 0           | 2           | 1          | $\frac{1}{4}$  | 0          | 10       |
  | $x_2$（-3） | $-\frac{1}{2}$ | 1           | 0           | 0          | $\frac{1}{4}$  | 0          | 3        |
  | $s_3$（0）  | $-\frac{5}{2}$ | 0           | 8           | 0          | $-\frac{3}{4}$ | 1          | 1        |
  | 目标行      | $\frac{1}{2}$  | 0           | 1           | 0          | $-\frac{3}{4}$ | 0          | -9       |



- **第 2 次 换基**（$x_3$ 进基、$s_3$ 离基）

  - **选定进基变量**（看目标行最正的系数对应的变量）：

    目标行中最正的系数为 $1$，对应变量 $x_3$。因此，$x_3$ 作为 **进基变量**。

  - **选定离基变量**（只看 $x_3$ 对应列的正数系数，找到 $\frac{右端常数}{系数}$ 最小比值）：

    发现 $s_3$ 对应的比值 $\frac{1}{8}$ 最小。因此，$s_3$ 作为 **离基变量**。

  将 $x_3$ 换到 $s_3$ 的基变量位置， 之后行变换，将 **进基变量** $x_3$ 这一列变为 **单位列**：

  | 基变量      | $x_1$（1）      | $x_2$（-3） | $x_3$（-1） | $s_1$（0） | $s_2$（0）       | $s_3$（0）     | 右端常数       |
  | ----------- | --------------- | ----------- | ----------- | ---------- | ---------------- | -------------- | -------------- |
  | $s_1$（0）  | $\frac{25}{8}$  | 0           | 0           | 1          | $\frac{7}{16}$   | $-\frac{1}{4}$ | $\frac{39}{4}$ |
  | $x_2$（-3） | $-\frac{1}{2}$  | 1           | 0           | 0          | $\frac{1}{4}$    | 0              | 3              |
  | $x_3$（-1） | $-\frac{5}{16}$ | 0           | 1           | 0          | $-\frac{3}{32}$  | $\frac{1}{8}$  | $\frac{1}{8}$  |
  | 目标行      | $\frac{13}{16}$ | 0           | 0           | 0          | $-\frac{21}{32}$ | $-\frac{1}{8}$ | $\frac{73}{8}$ |



- **第 3 次 换基**（$x_1$ 进基、$s_1$ 离基）

  - **选定进基变量**（看目标行最正的系数对应的变量）：

    目标行中最正的系数为 $\frac{13}{16}$，对应变量 $x_1$。因此，$x_1$ 作为 **进基变量**。

  - **选定离基变量**（只看 $x_1$ 对应列的正数系数，找到 $\frac{右端常数}{系数}$ 最小比值）：

    发现 $s_1$ 对应的比值 $\frac{78}{25}$ 最小。因此，$s_1$ 作为 **离基变量**。

  将 $x_1$ 换到 $s_1$ 的基变量位置， 之后行变换，将 **进基变量** $x_1$ 这一列变为 **单位列**：

  | 基变量      | $x_1$（1） | $x_2$（-3） | $x_3$（-1） | $s_1$（0）       | $s_2$（0）        | $s_3$（0）      | 右端常数          |
  | ----------- | ---------- | ----------- | ----------- | ---------------- | ----------------- | --------------- | ----------------- |
  | $x_1$（1）  | $1$        | $0$         | $0$         | $\frac{8}{25}$   | $\frac{7}{50}$    | $-\frac{2}{25}$ | $\frac{78}{25}$   |
  | $x_2$（-3） | $0$        | $1$         | $0$         | $\frac{4}{25}$   | $\frac{8}{25}$    | $-\frac{1}{25}$ | $\frac{114}{25}$  |
  | $x_3$（1）  | $0$        | $0$         | $1$         | $\frac{1}{10}$   | $-\frac{1}{20}$   | $\frac{1}{10}$  | $\frac{11}{10}$   |
  | 目标行      | $0$        | $0$         | $0$         | $-\frac{13}{50}$ | $-\frac{77}{100}$ | $-\frac{3}{50}$ | $-\frac{583}{50}$ |



经过第 3 次换基后，目标行所有系数都 $\le 0$，已经满足最优性条件。
**最优解**：
$$
x_1^{*} = \frac{78}{25}, \quad x_2^{*} = \frac{114}{25}, \quad x_3^{*} = \frac{11}{10}
$$
**目标函数最优值**：
$$
z_{\min} = -\frac{583}{50}
$$

---

