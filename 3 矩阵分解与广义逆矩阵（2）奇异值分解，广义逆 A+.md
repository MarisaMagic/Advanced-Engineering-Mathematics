<h1>
    <div align='center'>
        第三章 矩阵分解与广义逆矩阵（2）
        奇异值分解，广义逆 A+
    </div>
</h1>

## 奇异值分解

复杂度较高，暂时不掌握

---



## 广义逆 $A^{+}$

### 广义逆 $A^{+}$ 的定义
给一个矩阵 $A$（可以是方阵、也可以是长方阵、甚至奇异矩阵），我们希望找一个“类似逆矩阵”的东西 $A^{+}$，使得在一定意义下它“尽量像” $A^{-1}$。

**最基本的广义逆定义：**
矩阵 $B$ 若满足
$$
A B A = A,
$$
就叫 $B$ 是 $A$ 的一个**广义逆**（记作 $A^{(1)}$ 之类）。

在数值分析/线性代数里，常用的是满足 4 个条件的 **Moore–Penrose 伪逆**（通常就写 $A^{+}$）：

$$
\begin{align*}
(1)\quad & A A^{+} A = A,\\
(2)\quad & A^{+} A A^{+} = A^{+},\\
(3)\quad & (A A^{+})^{T} = A A^{+},\\
(4)\quad & (A^{+} A)^{T} = A^{+} A.
\end{align*}
$$
满足这 4 条的伪逆是**唯一的**。它有一些重要性质：

* 如果 $A$ 是可逆方阵，则 $A^{+} = A^{-1}$ ；
* 求最小二乘解 $Ax=b$ 时，正规方程的解可以写成 $x = A^{+} b$ 。

### 用满秩分解求 $A^{+}$

1. 先对 $A$ 进行满秩分解：
   $$
   A \in \mathbb{R}^{m\times n},\quad \mathrm{rank}(A)=r.
   $$
   做一个**满秩分解**：
   $$
   A = F G
   $$
   其中

   * $F$ 是 $m\times r$ 矩阵，列满秩（rank = r）；
   * $G$ 是 $r\times n$ 矩阵，行满秩（rank = r）。

2. **给 $F$ 和 $G$ 找“左右逆”**：

   * 对列满秩的 $F$（$m\times r$，$m\ge r$），可以构造它的 **左逆**：
     $$
     F^{\ell} = (F^{T} F)^{-1} F^{T},\quad F^{\ell} F = I_{r}.
     $$

   * 对行满秩的 $G$（$r\times n$，$n\ge r$），可以构造它的**右逆**：
     $$
     G^{r} = G^{T} (G G^{T})^{-1},\quad G, G^{r} = I_{r}.
     $$

3. **由 $A = FG$ 得到 $A^{+}$**：
   $$
   A^{+} = G^{r} F^{\ell}
   = G^{T} (G G^{T})^{-1} (F^{T} F)^{-1} F^{T}.
   $$

   可以验证它满足 Moore–Penrose 的 4 条性质，因此就是 $A$ 的伪逆。
   直观理解：

   * $F^{\ell}$ 先把 $\mathbb{R}^m$ 压到秩为 $r$ 的“核心空间”；
   * 再由 $G^{r}$ 把这个核心空间映射回 $\mathbb{R}^n$，完成“反向映射”。

**总结成一行公式**：

当 $A$ 有满秩分解 $A = F G$（$\mathrm{rank}(A)=r$）时，其伪逆（广义逆 $A^{+}$）可以写成：

$$
A^{+} = G^{T} (G G^{T})^{-1} (F^{T} F)^{-1} F^{T}
$$


## 用广义逆 $A^{+}$ 求解矛盾方程组

### 求解方法

**原理**：方程组 $Ax = b$ 有解等价于 $AA^{+}b = b$ 成立。

因此，可以通过求 $A^{+}b$ 作为方程组的特解。也就是先通过 $A^{+} = G^{T} (G G^{T})^{-1} (F^{T} F)^{-1} F^{T}$ 求得广义逆（前提是已经满秩分解得到了 $F$ 和 $G$），然后乘上 $b$ 向量得到特解 $A^{+}b$ 。

**极小范数最小二乘解**（特解）：$A^{+}b$

**全部最小二乘解**（通解）：$A^{+}b + (I - A^{+}A)y$



### 例题 1

> 用满秩分解法求矛盾方程组
> $$
> \begin{cases}
> 2x_1 + 4x_2 + x_3 + x_4 = 10 \\
> x_1 + 2x_2 - x_3 + 2x_4 = 6 \\
> -x_1 - 2x_2 - 2x_3 + x_4 = -7
> \end{cases}
> $$
> 的 全部最小二乘解 和 极小范数最小二乘解。

解答：

由题意得：
$$
A = \begin{pmatrix}
2 & 4 & 1 & 1 \\
1 & 2 & -1 & 2 \\
-1 & -2 & -2 & 1 
\end{pmatrix}, \quad
b = \begin{pmatrix}
10 \\ 6 \\ -7
\end{pmatrix}
$$

- 满秩分解求得 $F$ 和 $G$

  求得行最简阶梯型：
  $$
  \begin{pmatrix}
  1 & 2 & 0 & 1 \\
  0 & 0 & 1 & -1 \\
  0 & 0 & 0 & 0
  \end{pmatrix}
  $$
  取主元对应 **原矩阵** 的列得到 $F$，取主元对应 **行最简阶梯型** 的行得到 $G$：
  $$
  F = \begin{pmatrix}
  2 & 1 \\
  1 & -1 \\
  -1 & -2
  \end{pmatrix}, \quad
  G = \begin{pmatrix}
  1 & 2 & 0 & 1 \\
  0 & 0 & 1 & -1
  \end{pmatrix}
  $$

- 通过公式求广义逆 $A^{+}$
  $$
  A^{+} = G^{T}(G G^{T})^{-1} (F^{T} F)^{-1} F^{T}
  $$
  此处省略一万步.......求得 $A^{+}$：
  $$
  A^{+} = \frac{1}{33}
  \begin{pmatrix}
  2 & 1 & -1 \\
  4 & 2 & -2 \\
  1 & -5 & -6 \\
  1 & 6 & 5
  \end{pmatrix}
  $$

- **极小范数最小二乘解** $A^{+}b$
  $$
  A^{+}b = \begin{pmatrix}
  1 \\ 2 \\ \frac{2}{3} \\ \frac{1}{3}
  \end{pmatrix}
  $$

- **全部最小二乘解** $A^{+}b + (I - A^{+}A)y$
  $$
  A^{+}b + (I - A^{+}A)y = \begin{pmatrix}
  1 \\ 2 \\ \frac{2}{3} \\ \frac{1}{3}
  \end{pmatrix} + 
  \frac{1}{11} \begin{pmatrix}
  9 & -4 & -1 & -1 \\
  -4 & 3 & -2 & -2 \\
  -1 & 2 & 5 & 5 \\
  -1 & -2 & 5 & 5
  \end{pmatrix}
  \begin{pmatrix}
  y_1 \\ y_2 \\ y_3 \\ y_4
  \end{pmatrix}
  $$

---

